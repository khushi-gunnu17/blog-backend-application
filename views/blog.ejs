<!DOCTYPE html>

<html lang="en">

    <head>
        <%- include('./partials/head.ejs') %>
        <title>Blog Page</title>
    </head>

    <body>

        <%- include('./partials/nav.ejs') %>

        <div class="container my-4">
            <h1 class="mb-4"> <%= blog.title %> </h1>
            <img src=" <%= blog.coverImageURL %> " width="512px" />
            <pre class="my-5"><%= blog.body %></pre>
        </div>


        <div class="container mt-5">
            <img src="<%= blog.createdBy.profileImageUrl %>" width="50px"/>
            written by <%= blog.createdBy.fullName %>
        </div>


        <!-- submitting comments -->
        <div class="container mt-5">

            <h2 class="mb-4">Comments (<%= comments.length %>)</h2>

            <% if (locals.user) { %>

                <form action="/blog/comment/<%= blog._id %>" method="post">

                    <div class="mb-3">
                        <input type="text" class="form-control" name="content" placeholder="Enter your comment" />
                        <button type="submit" id="content" class="btn btn-sm btn-primary mt-2">Submit</button>
                    </div>
    
                </form>

            <% } %>

        </div>


        <!-- fetching all the comments -->
        <div class="mt-4 container border">
            <% comments.forEach(comment => { %>
                <div class="border mt-2">

                    <img src="<%= comment.createdBy.profileImageUrl %>" class="m-2" width="50px"/>
                    commented by <%= comment.createdBy.fullName %>
                    
                    <p class="mx-2 container" width="1000px">
                        <%= comment.content %>
                    </p>

                </div>
            <% }) %>
        </div>


        <%- include('./partials/scripts.ejs') %>

    </body>

</html>